<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌿 植物叶片病害识别系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container py-5">
        <!-- 头部标题 -->
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h1 class="display-4 text-white mb-3">
                    <i class="fas fa-leaf me-3"></i>植物叶片病害识别系统
                </h1>
                <p class="lead text-white-50">基于深度学习的植物叶片病害智能诊断系统</p>
                <div class="app-info-badge">
                    <span class="badge bg-light text-dark me-2">支持多种作物</span>
                    <span class="badge bg-light text-dark me-2">智能诊断</span>
                    <span class="badge bg-light text-dark">防治建议</span>
                </div>
            </div>
        </div>

        <div class="row justify-content-center">
            <!-- 左侧：上传和预测区域 -->
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-cloud-upload-alt me-2"></i>叶片图片上传与病害诊断
                    </div>
                    <div class="card-body">
                        <!-- 上传区域 -->
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-leaf fa-3x text-success mb-3"></i>
                            <h5>拖放叶片图片或点击上传</h5>
                            <p class="text-muted">支持 JPG, PNG, BMP, GIF 格式的叶片图片</p>
                            <p class="text-muted small">建议拍摄清晰的叶片正面和背面照片</p>
                            <input type="file" id="fileInput" accept="image/*" style="display: none;">
                            <button class="btn btn-success mt-2" onclick="document.getElementById('fileInput').click()">
                                <i class="fas fa-folder-open me-2"></i>选择叶片图片
                            </button>
                        </div>

                        <!-- 图片预览 -->
                        <div class="text-center mt-3">
                            <img id="previewImage" class="preview-img shadow">
                        </div>

                        <!-- 拍摄建议 -->
                        <div class="alert alert-info mt-3">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>拍摄建议：</strong>请确保叶片图片清晰、光线充足，尽量展示叶片整体和病害特征
                        </div>

                        <!-- 预测按钮 -->
                        <div class="text-center mt-4">
                            <button id="predictBtn" class="btn btn-success btn-lg" disabled>
                                <i class="fas fa-stethoscope me-2"></i>开始病害诊断
                            </button>
                        </div>

                        <!-- 加载指示器 -->
                        <div id="loadingIndicator" class="text-center mt-3" style="display: none;">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden">诊断中...</span>
                            </div>
                            <p class="text-muted mt-2">系统正在分析叶片病害，请稍候...</p>
                        </div>
                    </div>
                </div>

                <!-- 支持作物卡片 -->
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-seedling me-2"></i>支持识别的作物病害类型
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-4 mb-2">
                                <i class="fas fa-apple-alt text-primary"></i>
                                <div class="small">苹果黑星病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-apple-alt text-primary"></i>
                                <div class="small">苹果黑腐病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-apple-alt text-primary"></i>
                                <div class="small">苹果锈病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-apple-alt text-success"></i>
                                <div class="small">苹果健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-seedling text-success"></i>
                                <div class="small">蓝莓健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-cherry text-danger"></i>
                                <div class="small">樱桃白粉病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-cherry text-success"></i>
                                <div class="small">樱桃健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-wheat text-warning"></i>
                                <div class="small">玉米叶斑病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-wheat text-warning"></i>
                                <div class="small">玉米锈病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-wheat text-warning"></i>
                                <div class="small">玉米叶枯病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-wheat text-success"></i>
                                <div class="small">玉米健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-grapes text-danger"></i>
                                <div class="small">葡萄黑腐病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-grapes text-danger"></i>
                                <div class="small">葡萄黑麻疹病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-grapes text-danger"></i>
                                <div class="small">葡萄叶枯病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-grapes text-success"></i>
                                <div class="small">葡萄健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-orange text-warning"></i>
                                <div class="small">柑橘黄龙病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-peach text-danger"></i>
                                <div class="small">桃树细菌性斑点病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-peach text-success"></i>
                                <div class="small">桃树健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-pepper text-warning"></i>
                                <div class="small">甜椒细菌性斑点病</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-pepper text-success"></i>
                                <div class="small">甜椒健康</div>
                            </div>
                            <div class="col-4 mb-2">
                                <i class="fas fa-potato text-info"></i>
                                <div class="small">马铃薯早疫病</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API文档卡片 -->
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-code me-2"></i>API接口文档
                    </div>
                    <div class="card-body">
                        <div class="api-endpoint">
                            <strong>POST /api/predict</strong>
                            <p class="mb-1">叶片图片上传病害识别接口</p>
                            <small class="text-muted">Content-Type: multipart/form-data</small>
                        </div>
                        <div class="api-endpoint">
                            <strong>POST /api/predict_base64</strong>
                            <p class="mb-1">Base64叶片图片识别接口</p>
                            <small class="text-muted">Content-Type: application/json</small>
                        </div>
                        <div class="api-endpoint">
                            <strong>GET /api/health</strong>
                            <p class="mb-1">服务健康检查</p>
                        </div>
                        <div class="api-endpoint">
                            <strong>GET /api/classes</strong>
                            <p class="mb-1">获取所有病害分类信息</p>
                        </div>
                        <div class="api-endpoint">
                            <strong>GET /api/info</strong>
                            <p class="mb-1">获取应用信息</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧：诊断结果显示区域 -->
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-diagnoses me-2"></i>病害诊断结果
                    </div>
                    <div class="card-body">
                        <!-- 主要结果 -->
                        <div id="mainResult" style="display: none;">
                            <div class="text-center mb-4">
                                <div id="healthStatus" class="mb-3"></div>
                                <span id="predictionBadge" class="badge prediction-badge"></span>
                                <p class="text-muted mt-2">诊断置信度: <span id="confidenceValue" class="fw-bold"></span></p>
                            </div>

                            <!-- 防治建议 -->
                            <div id="recommendationBox" class="alert alert-info">
                                <h6><i class="fas fa-lightbulb me-2"></i>防治建议：</h6>
                                <p id="recommendationText" class="mb-0"></p>
                            </div>

                            <!-- 病害信息 -->
                            <div id="diseaseInfo" class="mt-3">
                                <h6>病害详细信息：</h6>
                                <div id="diseaseInfoContent" class="small text-muted">
                                    <!-- 病害信息将通过JS动态加载 -->
                                </div>
                            </div>

                            <!-- 置信度条 -->
                            <h6 class="mt-4">各类别诊断置信度:</h6>
                            <div id="confidenceBars"></div>
                        </div>

                        <!-- 原始JSON数据 -->
                        <div class="mt-4">
                            <h6>原始诊断数据:</h6>
                            <div class="json-box">
                                <pre id="jsonOutput" class="mb-0">请上传叶片图片进行病害诊断...</pre>
                            </div>
                        </div>

                        <!-- 错误信息 -->
                        <div id="errorAlert" class="alert alert-danger mt-3" style="display: none;">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <span id="errorMessage"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 页脚 -->
        <footer class="text-center text-white-50 mt-5">
            <p class="small">🌿 植物叶片病害识别系统 v1.0 | 基于深度学习技术 | 为农业生产提供智能诊断服务</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>